{{template "base" .}}

{{define "title"}}LORE // MTLA Registry{{end}}

{{define "content"}}
<!-- STATS OVERVIEW -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">Total Accounts</div>
        <div class="stat-value">{{.Stats.TotalAccounts}}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Persons (MTLAP)</div>
        <div class="stat-value">{{.Stats.TotalPersons}}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Corporate (MTLAC)</div>
        <div class="stat-value">{{.Stats.TotalCompanies}}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Total Portfolio Value</div>
        <div class="stat-value">{{formatNumber .Stats.TotalXLMValue}}<span class="unit">XLM</span></div>
    </div>
</div>

<!-- PERSONS SECTION -->
<section class="section" id="persons-section">
    <div class="section-header">
        <h2 class="section-title">Persons</h2>
        <span class="section-badge">MTLAP</span>
        <span class="section-count">{{.Stats.TotalPersons}} registered</span>
    </div>
    {{if .Persons}}
    <div class="table-wrapper">
        <table class="data-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Name</th>
                    <th>Account</th>
                    <th class="right">Balance</th>
                    <th class="right">Vote</th>
                </tr>
            </thead>
            <tbody>
                {{range $i, $p := .Persons}}
                <tr class="row-link" onclick="window.location='/accounts/{{$p.AccountID}}'">
                    <td class="cell-rank">{{add (add $i $.PersonsOffset) 1}}</td>
                    <td class="cell-name">
                        <a href="/accounts/{{$p.AccountID}}">{{$p.Name}}</a>
                    </td>
                    <td class="cell-id">{{truncate $p.AccountID 6}}...{{slice $p.AccountID 50}}</td>
                    <td class="cell-num">{{printf "%.2f" $p.MTLAPBalance}}</td>
                    <td class="cell-votes">
                        <span class="votes-count">{{votePower (addFloat $p.MTLAPBalance $p.ReceivedVotes)}}</span>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{if .HasMorePersons}}
    <div class="pagination">
        <a href="?persons_offset={{.NextPersonsOffset}}{{if .CorporateOffset}}&corporate_offset={{.CorporateOffset}}{{end}}#persons-section" class="btn">Load More &gt;</a>
    </div>
    {{end}}
    {{else}}
    <div class="empty">No persons found</div>
    {{end}}
</section>

<!-- CORPORATE SECTION -->
<section class="section" id="corporate-section">
    <div class="section-header">
        <h2 class="section-title">Corporate</h2>
        <span class="section-badge mtlac">MTLAC</span>
        <span class="section-count">{{.Stats.TotalCompanies}} registered</span>
    </div>
    {{if .Corporate}}
    <div class="table-wrapper">
        <table class="data-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Name</th>
                    <th>Account</th>
                    <th class="right">Tier</th>
                    <th class="right">Portfolio</th>
                </tr>
            </thead>
            <tbody>
                {{range $i, $c := .Corporate}}
                <tr class="row-link" onclick="window.location='/accounts/{{$c.AccountID}}'">
                    <td class="cell-rank">{{add (add $i $.CorporateOffset) 1}}</td>
                    <td class="cell-name">
                        <a href="/accounts/{{$c.AccountID}}">{{$c.Name}}</a>
                    </td>
                    <td class="cell-id">{{truncate $c.AccountID 6}}...{{slice $c.AccountID 50}}</td>
                    <td class="cell-num">{{printf "%.2f" $c.MTLACBalance}}</td>
                    <td class="cell-xlm">{{formatNumber $c.TotalXLMValue}} XLM</td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{if .HasMoreCorporate}}
    <div class="pagination">
        <a href="?{{if .PersonsOffset}}persons_offset={{.PersonsOffset}}&{{end}}corporate_offset={{.NextCorporateOffset}}#corporate-section" class="btn">Load More &gt;</a>
    </div>
    {{end}}
    {{else}}
    <div class="empty">No corporate accounts found</div>
    {{end}}
</section>
{{end}}
